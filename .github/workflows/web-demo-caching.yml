name: Web test with caching

on:
 push:
  branches: main
 workflow_dispatch:

jobs:
 build:
  name: run web test
  runs-on: windows-latest

  steps:
    - name: Pull code from workspace to the runner
      if: github.actor == 'Mandeepsheoran'
      uses: actions/checkout@v2
      timeout-minutes: 10

    - name: Setup Java 17
      uses: actions/setup-java@v1
      timeout-minutes: 10
      with:
          java-version: 17
          
    - name: store docker image cache
      uses: satackey/action-docker-layer-caching@v0.0.11
      continue-on-error: true
      
    - name: Restore Maven cache
      uses: skjolber/maven-cache-github-action@v1
      continue-on-error: true
      with:
         step: restore  

    - name: Run test with Maven
      timeout-minutes: 10
      run: |
         mvn -v 
         mvn clean install -Pweb-testng
         
    - name: Save Maven cache
      uses: skjolber/maven-cache-github-action@v1
      continue-on-error: true
      with:
         step: save
  
 
